#!/bin/bash

# mocp /home/pi/Music
# uncomment for audio player first

# vgmplay-AR! executes by ./initial_script.sh

cd /home/pi/Music/vgmSet
files=(*.vgm)
count=0
inpt=""
end=false
regex='^0-9+$' 

listTracks(){
  count=0
  echo ""
  echo "files in ~/Music/vgmSet"
  echo ""

  for filename in ${files[@]}
  do
    echo $count $filename
    ((count++))
  done

  echo ""
}

selectTrack(){
  echo -n "pleez select your track: "

  read -n 2 inpt

  # need to handle errors here
  # if detect q exit program
  # if not a valid  number select again

  if [ $inpt = "q" ]
  then
    $end = true
  fi

#  if [ $inpt > ${#files[@]} ]
#  then
#    echo "eRr0R => trY agAiN ...f0oL."
#    echo ""
#    selectTrack
#  fi

  if [ $inpt != $re ]#  then
#    echo "eRr0R => nAn doOD."
#  else
#    selectTrack
#  fi

  echo ""
}

playTrack(){
  vgmplay ${files[inpt]}
}

while :
do
  listTracks
  selectTrack
  if [ $end ]
  then
    echo "...EXIT"
    sleep .5s
    echo ""
    sleep .5s
    echo "...FINE"
    sleep .5s
    echo ""
    sleep .5s
    break
  else
    playTrack
  fi
done
